local Concord = require("modules.concord.concord")

local Typewriter = Concord.system({
	pool = {"text", "reflowprint"},
})

function Typewriter:init(world)
	self.world = world
end

function Typewriter:update(dt)
	for _, e in ipairs(self.pool) do
		if not e.dialogue_finished then
			local text = e.text.value
			local rfp = e.reflowprint
			rfp.dt = rfp.dt + dt * rfp.speed
			if rfp.dt * #text > #text then
				e.dialogue_item.can_proceed = true
			end
		end
	end
end

return Typewriter
